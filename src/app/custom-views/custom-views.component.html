
<form [formGroup]="form">

    <div class="form-group" >
      <label for="selectedView">Custom Views</label>

      <p-dropdown id="selectedView" formControlName="selectedView" (onChange)="selectedViewChange($event)"
          [options]="(state.entities$| async) || []" 
          
          optionLabel="name"
          dataKey="id"
          >
          <ng-template let-view pTemplate="item">
              <div class="flex align-items-center gap-2">
                  <div>{{ view.name }}</div>
              </div>
          </ng-template>
      </p-dropdown>
      <p-button (click)="editSelectedClick()" label="Edit View" styleClass="p-button-text"></p-button>
      <p-button (click)="addNewClick()" label="Add View" styleClass="p-button-text"></p-button>

      <p-confirmDialog [style]="{width: '50vw'}"></p-confirmDialog>
      <p-button (click)="confirmDelete($event)" label="Delete View" styleClass="p-button-text"></p-button>

    </div>

    <br><br>
    <div class="form-group" *ngFor="let param of (selectedViewParams$ | async); let i=index">
        <label [for]="'viewParam'+i">{{param.name}}</label>
        <input [id]="'viewParam'+i" [formControlName]="param.name" pInputText class="input-control" />
    </div>

    <br>
    <div class="action-buttons">
        <p-button (click)="runClick()">Run</p-button>
    </div>

    <br><br>

    <p-table [columns]="viewDataCols" [value]="viewData" [tableStyle]="{ 'min-width': '50rem' }">
        <ng-template pTemplate="header" let-columns>
            <tr>
                <th *ngFor="let col of columns">
                    {{ col }}
                </th>
            </tr>
        </ng-template>
        <ng-template pTemplate="body" let-rowData let-columns="columns">
            <tr>
                <td *ngFor="let col of columns">
                    {{ rowData[col] }}
                </td>
            </tr>
        </ng-template>
    </p-table>

</form>
